import datetime
import os
import xlrd
import openpyxl
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
import time
import winreg

# 对时间进行处理
# 月日
today_date = datetime.datetime.today().strftime("%m%d")  # 不带中字0901
today = datetime.datetime.today()

# 计算偏移量

date7 = today - datetime.timedelta(days=8)
date7_date7 = date7.strftime("%m%d")  # 八天前
date7_date7_date7 = date7.strftime("%Y-%m-%d")  # 格式2021-11-01
date7_date = date7.strftime("%#m{m}%d{d}").format(m='月', d='日')  # 八天前

# time.strftime('%Y{y}%m{m}%d{d} %H{h}%M{f}%S{s}').format(y='年',m='月',d='日',h='时',f='分',s='秒')


date6 = today - datetime.timedelta(days=7)
date6_date6_date6 = date6.strftime("%Y-%m-%d")  # 格式2021-11-01
date6_date = date6.strftime("%#m{m}%d{d}").format(m='月', d='日')  # 七天前

date5 = today - datetime.timedelta(days=6)
date5_date5_date5 = date5.strftime("%Y-%m-%d")  # 格式2021-11-01
date5_date = date5.strftime("%#m{m}%d{d}").format(m='月', d='日')  # 六天前

date4 = today - datetime.timedelta(days=5)
date4_date4_date4 = date4.strftime("%Y-%m-%d")  # 格式2021-11-01
date4_date = date4.strftime("%#m{m}%d{d}").format(m='月', d='日')  # 五天前

date3 = today - datetime.timedelta(days=4)
date3_date3_date3 = date3.strftime("%Y-%m-%d")  # 格式2021-11-01
date3_date = date3.strftime("%#m{m}%d{d}").format(m='月', d='日')  # 四天前

date2 = today - datetime.timedelta(days=3)
date2_date2_date2 = date2.strftime("%Y-%m-%d")  # 格式2021-11-01
date2_date = date2.strftime("%#m{m}%d{d}").format(m='月', d='日')  # 三天前

date1 = today - datetime.timedelta(days=2)
date1_date1 = date1.strftime("%m%d")  # 八天前
date1_date1_date1 = date1.strftime("%Y-%m-%d")  # 格式2021-11-01
date1_date = date1.strftime("%#m{m}%d{d}").format(m='月', d='日')  # 二天前


# 设置无界面
options = webdriver.ChromeOptions()
# 不加载图片
# prefs = {"profile.managed_default_content_settings.images":2}
# options.add_experimental_option("prefs",prefs)
# options.add_argument('--headless')
# options.add_argument('--disable-gpu')

# 创建浏览器对象
brower = webdriver.Chrome(options=options)
# 浏览器最大化
brower.maximize_window()
brower.get('')
brower.implicitly_wait(10)

# 输入用户名
brower.find_element_by_xpath('//*[@id="root"]/div/main/form/div[1]/div/input').send_keys('test')
# 输入密码
brower.find_element_by_xpath('//*[@id="root"]/div/main/form/div[2]/div/input').send_keys('Szmgmah@2021')
# 模拟点击登录按钮
brower.find_element_by_xpath(
    '//*[@id="root"]/div/main/form/div[4]/input').click()

brower.find_element_by_xpath('//*[@id="root"]/div/div[1]/div[2]/div[2]/a[2]').click()

brower.find_element_by_xpath('//*[@id="root"]/div/div[2]/div/div[1]/ul/li[1]/div/span[2]').click()

brower.find_element_by_xpath('//*[@id="22$Menu"]/li[4]').click()

#点击已通过
brower.find_element_by_xpath('/html/body/div[1]/div/div/div/ul/li[2]/a').click()
#点击筛选
brower.find_element_by_xpath('/html/body/div[1]/div/div/div/div[2]/div/div/div/button/i').click()
#点击申请时间 并在第一个日期框里输入八天前时间
brower.find_element_by_xpath('//*[@id="start"]').send_keys(date7_date7_date7)
#点击第二个日期框输入八天前时间
brower.find_element_by_xpath('//*[@id="end"]').send_keys(date7_date7_date7)
#点击搜索
brower.find_element_by_xpath('/html/body/div[1]/div/div/div/div[2]/div/div/div/div/div[6]/button').click()
#强制停止0.1S给网页反应时间
time.sleep(1)
znmz7  = brower.find_element_by_css_selector(
    'div.pager-box>div>div:nth-child(2)>span:nth-child(1)>span').text

print(date7_date7_date7 +" "+znmz7)


#点击筛选
brower.find_element_by_xpath('/html/body/div[1]/div/div/div/div[2]/div/div/div/button/i').click()
#清除申请时间第二个日期框里的内容
brower.find_element_by_xpath('//*[@id="end"]').clear()
#第二个日期框输入七天前时间
brower.find_element_by_xpath('//*[@id="end"]').send_keys(date6_date6_date6)
#清除申请时间第一个日期框里的内容
brower.find_element_by_xpath('//*[@id="start"]').clear()
#第一个日期框输入七天前时间
brower.find_element_by_xpath('//*[@id="start"]').send_keys(date6_date6_date6)
#再次点击
brower.find_element_by_xpath('//*[@id="start"]').click()

brower.find_element_by_xpath('/html/body/div[1]/div/div/div/div[2]/div/div/div/div/div[6]/button').click()
time.sleep(1)
znmz6  = brower.find_element_by_css_selector(
    'div.pager-box>div>div:nth-child(2)>span:nth-child(1)>span').text
print( date6_date6_date6+" "+znmz6)
